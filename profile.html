<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>repl.it</title>
    <link href="/bigben/scripts/style.css" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@500&display=swap" rel="stylesheet">
  </head>
  <body>
    <script>
    function signOut(){
    localStorage.removeItem("userToken");
    location = "/bigben/";
}
  function goSomewhere(x){
window.location = x;
}
    function startOffer(){
        if(localStorage.getItem("userToken")){
          document.getElementById("changeToName").innerHTML = "<p onclick='signOut()' class='text' style='display:inline-block;float:right;'>Sign Out</p>";
      }
    }
  </script>
  <script>
    //If you copy this code, at least give us credit
    var userToken = localStorage.getItem("userToken");
var url = new URL(location.href);
var otherUser = url.searchParams.get("user");
console.log(otherUser);
function getUserData(){
  var userToken = localStorage.getItem("userToken");
  var url = new URL(location.href);
  var otherUser = url.searchParams.get("user");
console.log(otherUser);
  const h1 = document.querySelector('#username');
  const h2 = document.querySelector('#benbucks');
  if(userToken){
    console.log("The Doc is in");
    if(otherUser){
      console.log("other user named "+otherUser);
      db.collection("users")
      .where('username',"==",otherUser)
      .get()
      .then(function(snapshot){
        if(snapshot.empty){
          console.log("user doesn't exists");
          h1.textContent = "user doesn't exists"
          h2.textContent = ""
        }else{
          console.log("user exists");
          h1.textContent = snapshot.docs[0].data().username;
          h2.textContent = snapshot.docs[0].data().benBucks;
        }
      })
    }else{
      console.log("our user should show");
      db.collection('users')
      .doc(userToken)
      .get()
      .then(function(snapshot){
        h1.textContent = snapshot.data().username
        h2.textContent = snapshot.data().benBucks
      })
    }
  }else{
    console.log("The Doc is out");
    //location.href = "index.html" <-- signup page
  }

}
getUserData();
function search(){
  var hello = document.querySelector("#text").value;
  console.log(hello);
  history.pushState({
    id: 'profile'
}, 'profile', '?user='+hello);
  var url = new URL(location.href);
  var otherUser = url.searchParams.get("user");
  getUserData();
}
  </script>
  <div class="header">
      <div id="changeToName"><p onclick="signOut()" class="text" style="display:inline-block;float:right;">Sign Out</p></div><a href="/bigben/" style="text-decoration:none;"><p class="text" style="font-size:30px;margin:0px;padding:10px;">BigBen</p></a>
      <br> 
    </div>
    <input style="text-align:left;margin:30px;" class="textinput" type="text" onkeyup="search()" id="text">
    <style>
  .add-friend,
  .remove-friend{
    display:none;
  }
</style>
<h1 class="text" id="username"></h1>
<h2 class="text" id="benbucks"></h2>
<button class="add-friend">Add Friends</button>
<button class="remove-friend">Remove Friends</button>
<ul class="text">
<ul class="text">
<script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-firestore.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
<script>
  var firebaseConfig = {
    apiKey: "AIzaSyAcPOlFIiQZz8V9flKVbLA7TaYs1Q6_AWs",
    authDomain: "bigben-finances.firebaseapp.com",
    databaseURL: "https://bigben-finances.firebaseio.com",
    projectId: "bigben-finances",
    storageBucket: "bigben-finances.appspot.com",
    messagingSenderId: "1046658245162",
    appId: "1:1046658245162:web:083464e0dded0950fa1953",
    measurementId: "G-24YR5YR7K3"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth()
  const db = firebase.firestore();
</script>
  </body>
</html>
